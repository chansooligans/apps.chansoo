<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- d3 -->
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

    <!-- leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'css/leaflet.css' %}">

    <title>JERSEY</title>
</head>

<body>
    <div class="container">
        <h1>Jersey Map</h1>
        <div id="map"></div>
    </div>
</body>

<script>
    var map = L.map('map').setView([40.11851, -74.671826], 8);

    var geojson;

    d3.json("{{ geojson_url }}", function (error, data) {
        if (error) throw error;

        geojson = data;

        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        function style(feature) {
            var value = feature.properties["edu_college"] / feature.properties["total_pop"];

            // Define the fill color based on the value
            var fillColor;
            if (value < 0.10) {
                fillColor = '#F13D16';
            } else if (value >= 0.10 && value < 0.20) {
                fillColor = '#F09D8B';
            } else if (value >= 0.20 && value < 0.30) {
                fillColor = '#8BBDF0';
            } else {
                fillColor = '#0153A7';
            }

            return {
                fillColor: fillColor,
                weight: 1,
                opacity: 0.4,
                color: 'white',
                dashArray: '3',
                fillOpacity: 0.4
            };
        }

        function onEachFeature(feature, layer) {
            layer.bindTooltip(
                "Value: " + feature.properties["edu_college"] / feature.properties["total_pop"],
                { permanent: false, direction: 'center', className: 'myCSSClass' }
            );
            layer.on({
                mouseover: function (e) {
                    this.openTooltip();
                },
                mouseout: function (e) {
                    this.closeTooltip();
                }
            });
        }

        L.geoJSON(geojson, { style: style, onEachFeature: onEachFeature }).addTo(map);

    });


</script>

</html>